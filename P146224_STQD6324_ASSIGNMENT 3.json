{"paragraphs":[{"text":"sc.version","user":"anonymous","dateUpdated":"2025-07-16T15:29:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: String = 2.3.0.2.6.5.0-292\n"}]},"apps":[],"jobName":"paragraph_1752594188599_-437937263","id":"20250715-154308_2060622410","dateCreated":"2025-07-15T15:43:08+0000","dateStarted":"2025-07-16T15:29:17+0000","dateFinished":"2025-07-16T15:29:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:273"},{"title":"Download the dataset","text":"%sh\n\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data #download u.data\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item #download u.item\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.user -O /tmp/u.user #download u.user\necho \"Downloaded!\"","user":"anonymous","dateUpdated":"2025-07-16T15:29:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2025-07-16 15:29:26--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 16.182.41.113, 52.217.131.9, 3.5.29.213, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|16.182.41.113|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2%  103K 19s\n    50K .......... .......... .......... .......... ..........  4%  159K 15s\n   100K .......... .......... .......... .......... ..........  7% 4.45M 10s\n   150K .......... .......... .......... .......... ..........  9%  784K 8s\n   200K .......... .......... .......... .......... .......... 12%  319K 7s\n   250K .......... .......... .......... .......... .......... 14%  703K 6s\n   300K .......... .......... .......... .......... .......... 17%  270K 6s\n   350K .......... .......... .......... .......... .......... 19% 8.07M 5s\n   400K .......... .......... .......... .......... .......... 22%  392K 5s\n   450K .......... .......... .......... .......... .......... 24% 14.8M 4s\n   500K .......... .......... .......... .......... .......... 27%  531K 4s\n   550K .......... .......... .......... .......... .......... 29%  494K 4s\n   600K .......... .......... .......... .......... .......... 32% 6.44M 3s\n   650K .......... .......... .......... .......... .......... 34%  445K 3s\n   700K .......... .......... .......... .......... .......... 36%  593K 3s\n   750K .......... .......... .......... .......... .......... 39% 12.9M 3s\n   800K .......... .......... .......... .......... .......... 41%  428K 3s\n   850K .......... .......... .......... .......... .......... 44% 42.9M 2s\n   900K .......... .......... .......... .......... .......... 46%  164K 3s\n   950K .......... .......... .......... .......... .......... 49% 16.6M 2s\n  1000K .......... .......... .......... .......... .......... 51% 11.3M 2s\n  1050K .......... .......... .......... .......... .......... 54% 8.05M 2s\n  1100K .......... .......... .......... .......... .......... 56%  555K 2s\n  1150K .......... .......... .......... .......... .......... 59% 5.12M 2s\n  1200K .......... .......... .......... .......... .......... 61%  513K 2s\n  1250K .......... .......... .......... .......... .......... 64% 1.45M 1s\n  1300K .......... .......... .......... .......... .......... 66% 1.19M 1s\n  1350K .......... .......... .......... .......... .......... 68%  600K 1s\n  1400K .......... .......... .......... .......... .......... 71%  652K 1s\n  1450K .......... .......... .......... .......... .......... 73% 1.06M 1s\n  1500K .......... .......... .......... .......... .......... 76% 1.03M 1s\n  1550K .......... .......... .......... .......... .......... 78%  943K 1s\n  1600K .......... .......... .......... .......... .......... 81% 1.19M 1s\n  1650K .......... .......... .......... .......... .......... 83% 1.10M 1s\n  1700K .......... .......... .......... .......... .......... 86% 1.05M 0s\n  1750K .......... .......... .......... .......... .......... 88% 1.17M 0s\n  1800K .......... .......... .......... .......... .......... 91%  811K 0s\n  1850K .......... .......... .......... .......... .......... 93%  802K 0s\n  1900K .......... .......... .......... .......... .......... 96%  908K 0s\n  1950K .......... .......... .......... .......... .......... 98% 1.24M 0s\n  2000K .......... .......... ..........                      100%  808K=3.3s\n\n2025-07-16 15:29:30 (620 KB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\n--2025-07-16 15:29:30--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 16.182.41.113, 52.217.131.9, 3.5.29.213, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|16.182.41.113|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21%  101K 2s\n    50K .......... .......... .......... .......... .......... 43%  163K 1s\n   100K .......... .......... .......... .......... .......... 64% 3.37M 0s\n   150K .......... .......... .......... .......... .......... 86%  799K 0s\n   200K .......... .......... ..........                      100%  245K=1.0s\n\n2025-07-16 15:29:32 (230 KB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\n--2025-07-16 15:29:32--  http://media.sundog-soft.com/hadoop/ml-100k/u.user\nResolving media.sundog-soft.com (media.sundog-soft.com)... 3.5.25.153, 3.5.2.79, 52.217.168.241, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|3.5.25.153|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 22628 (22K) [text/plain]\nSaving to: ‘/tmp/u.user’\n\n     0K .......... .......... ..                              100% 67.1K=0.3s\n\n2025-07-16 15:29:33 (67.1 KB/s) - ‘/tmp/u.user’ saved [22628/22628]\n\nDownloaded!\n"}]},"apps":[],"jobName":"paragraph_1752594247163_-1397039650","id":"20250715-154407_1043387702","dateCreated":"2025-07-15T15:44:07+0000","dateStarted":"2025-07-16T15:29:26+0000","dateFinished":"2025-07-16T15:29:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:274"},{"title":"Move to HDFS","text":"%sh\nhadoop fs -rm -r -f /tmp/ml-100k\n\nhadoop fs -mkdir /tmp/ml-100k\n\nhadoop fs -put -f /tmp/u.data /tmp/ml-100k/ #put u.data in HDFS\nhadoop fs -put -f /tmp/u.item /tmp/ml-100k/ #put u.item in HDFS\nhadoop fs -put -f /tmp/u.user /tmp/ml-100k/ #put u.user in HDFS","user":"anonymous","dateUpdated":"2025-07-16T15:29:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"25/07/16 15:29:42 INFO fs.TrashPolicyDefault: Moved: 'hdfs://sandbox-hdp.hortonworks.com:8020/tmp/ml-100k' to trash at: hdfs://sandbox-hdp.hortonworks.com:8020/user/zeppelin/.Trash/Current/tmp/ml-100k1752679782218\n"}]},"apps":[],"jobName":"paragraph_1752596015252_1566805366","id":"20250715-161335_519026293","dateCreated":"2025-07-15T16:13:35+0000","dateStarted":"2025-07-16T15:29:36+0000","dateFinished":"2025-07-16T15:30:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:275"},{"text":"%spark2.pyspark\r\n\r\n#Load u.data\r\ndata = sc.textFile(\"hdfs:///tmp/ml-100k/u.data\") \\\r\n    .map(lambda line: line.split(\"\\t\")) \\\r\n    .map(lambda p: Row(user_id=int(p[0]), movie_id=int(p[1]), rating=int(p[2]), timestamp=int(p[3])))\r\n\r\n#Convert to DataFrame\r\nratings_df = spark.createDataFrame(data)\r\n\r\n#SQL view\r\nratings_df.createOrReplaceTempView(\"ratings\")","user":"anonymous","dateUpdated":"2025-07-16T16:43:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752684022836_-1160072364","id":"20250716-164022_1063669226","dateCreated":"2025-07-16T16:40:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2513","dateFinished":"2025-07-16T16:41:39+0000","dateStarted":"2025-07-16T16:41:37+0000","title":"i- Average rating for each movie","results":{"code":"SUCCESS","msg":[]}},{"text":"%sql\r\nSELECT movie_id,\r\n       ROUND(AVG(rating), 2) AS avg_rating\r\nFROM ratings\r\nGROUP BY movie_id\r\nORDER BY movie_id\r\nLIMIT 10","user":"anonymous","dateUpdated":"2025-07-16T16:41:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752684082789_2140931993","id":"20250716-164122_913758","dateCreated":"2025-07-16T16:41:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2572","dateFinished":"2025-07-16T16:42:05+0000","dateStarted":"2025-07-16T16:41:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movie_id\tavg_rating\n1\t3.88\n2\t3.21\n3\t3.03\n4\t3.55\n5\t3.3\n6\t3.58\n7\t3.8\n8\t4.0\n9\t3.9\n10\t3.83\n"}]}},{"text":"%md\nThe output above shows the average rating for the first 10 movie. From the result, it shows that movie from movie_id = '8' has the average rating of 4.0. Meanwhile, movie_id = '1', '2', '3', '4', '5', '6', '7 and '9 has average rating between 3.0 to 3.9.\n","user":"anonymous","dateUpdated":"2025-07-16T16:45:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The output above shows the average rating for the first 10 movie. From the result, it shows that movie from movie_id = '8' has the average rating of 4.0. Meanwhile, movie_id = '1', '2', '3', '4', '5', '6', '7 and '9 has average rating between 3.0 to 3.9.</p>\n"}]},"apps":[],"jobName":"paragraph_1752664171584_-1841437327","id":"20250716-110931_1825422926","dateCreated":"2025-07-16T11:09:31+0000","dateStarted":"2025-07-16T16:45:44+0000","dateFinished":"2025-07-16T16:45:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:277"},{"title":"Top 10 movies with the highest average ratings","text":"%sql\r\nSELECT i.movie_id, i.movie_title, a.avg_rating\r\nFROM avg_ratings a\r\nJOIN (\r\n    SELECT cast(split(value, \"\\\\|\")[0] AS INT) AS movie_id,\r\n           split(value, \"\\\\|\")[1] AS movie_title\r\n    FROM text.`hdfs:///tmp/ml-100k/u.item`\r\n) i\r\nON a.movie_id = i.movie_id\r\nORDER BY a.avg_rating DESC\r\nLIMIT 10","user":"anonymous","dateUpdated":"2025-07-16T15:34:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movie_id\tmovie_title\tavg_rating\n1201\tMarlene Dietrich: Shadow and Light (1996) \t5.0\n1653\tEntertaining Angels: The Dorothy Day Story (1996)\t5.0\n1467\tSaint of Fort Washington, The (1993)\t5.0\n1122\tThey Made Me a Criminal (1939)\t5.0\n1189\tPrefontaine (1997)\t5.0\n1500\tSanta with Muscles (1996)\t5.0\n1293\tStar Kid (1997)\t5.0\n1536\tAiqing wansui (1994)\t5.0\n814\tGreat Day in Harlem, A (1994)\t5.0\n1599\tSomeone Else's America (1995)\t5.0\n"}]},"apps":[],"jobName":"paragraph_1752601073395_365945738","id":"20250715-173753_1361480491","dateCreated":"2025-07-15T17:37:53+0000","dateStarted":"2025-07-16T15:34:24+0000","dateFinished":"2025-07-16T15:34:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:278"},{"text":"%md\nThe output above shows top 10 movies with the highest average ratings. From the result, it shows that all the ten movies has the average rating of 5.0. The top highest movies in the data is Marlene Dietrich: Shadow and Light (1996) followed by Entertaining Angels: The Dorothy Day Story (1996), Saint of Fort Washington, The (1993), They Made Me a Criminal (1939), Prefontaine (1997), Santa with Muscles (1996), Star Kid (1997), Aiqing wansui (1994), Great Day in Harlem, A (1994) and Someone Else's America (1995).\n","user":"anonymous","dateUpdated":"2025-07-16T11:31:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The output above shows top 10 movies with the highest average ratings. From the result, it shows that all the ten movies has the average rating of 5.0. The top highest movies in the data is Marlene Dietrich: Shadow and Light (1996) followed by Entertaining Angels: The Dorothy Day Story (1996), Saint of Fort Washington, The (1993), They Made Me a Criminal (1939), Prefontaine (1997), Santa with Muscles (1996), Star Kid (1997), Aiqing wansui (1994), Great Day in Harlem, A (1994) and Someone Else's America (1995).</p>\n"}]},"apps":[],"jobName":"paragraph_1752664981775_-1517116430","id":"20250716-112301_947764534","dateCreated":"2025-07-16T11:23:01+0000","dateStarted":"2025-07-16T11:31:53+0000","dateFinished":"2025-07-16T11:31:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:279"},{"title":"The users who have rated at least 50 movies and their favourite movie genres","text":"%spark2.pyspark\r\n\r\n#Load ratings (to identify users who rated at least 50 movies)\r\nratings = sc.textFile(\"hdfs:///tmp/ml-100k/u.data\") \\\r\n    .map(lambda line: line.split(\"\\t\")) \\\r\n    .map(lambda p: (int(p[0]), int(p[1])))  #(user_id, movie_id)\r\n\r\n#Count ratings per user\r\nuser_rating_count = ratings.map(lambda x: (x[0], 1)).reduceByKey(lambda a, b: a + b)\r\n\r\n#Filter users with at least 50 ratings\r\nactive_users = user_rating_count.filter(lambda x: x[1] >= 50)\r\n\r\n# Show top 10 most active users\r\nactive_users.takeOrdered(10, key=lambda x: -x[1])\r\n\r\n#Convert to DataFrame\r\nfrom pyspark.sql import Row\r\nuser_rows = active_users.map(lambda x: Row(user_id=x[0], rating_count=x[1]))\r\nactive_user_df = spark.createDataFrame(user_rows)\r\nactive_user_df.createOrReplaceTempView(\"active_users\")\r\nactive_user_df.orderBy(active_user_df.rating_count.desc()).show(10)","user":"anonymous","dateUpdated":"2025-07-16T15:34:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-------+\n|rating_count|user_id|\n+------------+-------+\n|         737|    405|\n|         685|    655|\n|         636|     13|\n|         540|    450|\n|         518|    276|\n|         493|    416|\n|         490|    537|\n|         484|    303|\n|         480|    234|\n|         448|    393|\n+------------+-------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1752667928372_643171197","id":"20250716-121208_1477871013","dateCreated":"2025-07-16T12:12:08+0000","dateStarted":"2025-07-16T15:34:58+0000","dateFinished":"2025-07-16T15:35:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:280"},{"text":"%md\nThe output above shows the top ten users who have rated at least 50 movies. From the results above, it shows that user 405 is the most active user that have rated 737 movies. The second highest user are user 655 with the number of movies rated is 685, followed by user 13 with 636 movies, user 450 with 540 movies, user 276 with 518 movies, user 416 with 493 movies, user 537 with 490 movies, user 303 with 484 movies, user 234 with 480 movies and user 393 with 448 movies.  \n","user":"anonymous","dateUpdated":"2025-07-16T13:50:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The output above shows the top ten users who have rated at least 50 movies. From the results above, it shows that user 405 is the most active user that have rated 737 movies. The second highest user are user 655 with the number of movies rated is 685, followed by user 13 with 636 movies, user 450 with 540 movies, user 276 with 518 movies, user 416 with 493 movies, user 537 with 490 movies, user 303 with 484 movies, user 234 with 480 movies and user 393 with 448 movies.</p>\n"}]},"apps":[],"jobName":"paragraph_1752673159899_-91240598","id":"20250716-133919_360605567","dateCreated":"2025-07-16T13:39:19+0000","dateStarted":"2025-07-16T13:50:12+0000","dateFinished":"2025-07-16T13:50:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:281"},{"text":"%spark2.pyspark\r\n\r\n# Load u.item and explode genres\r\nitems = sc.textFile(\"hdfs:///tmp/ml-100k/u.item\") \\\r\n    .map(lambda line: line.split('|')) \\\r\n    .map(lambda p: (int(p[0]), p[5:]))\r\ngenres = ['unknown','Action','Adventure','Animation','Children\\'s','Comedy','Crime',\r\n          'Documentary','Drama','Fantasy','Film-Noir','Horror','Musical','Mystery',\r\n          'Romance','Sci-Fi','Thriller','War','Western']\r\n# Convert to exploded (movie_id, genre) rows\r\nmovie_genre_rows = items.flatMap(\r\n    lambda x: [(x[0], genres[i]) for i, v in enumerate(x[1]) if v == '1']\r\n).map(lambda x: Row(movie_id=x[0], genre=x[1]))\r\nmovie_genre_df = spark.createDataFrame(movie_genre_rows)\r\nmovie_genre_df.createOrReplaceTempView(\"movie_genres\")","user":"anonymous","dateUpdated":"2025-07-16T16:48:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752684526001_-1749415210","id":"20250716-164846_1693728115","dateCreated":"2025-07-16T16:48:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2918","dateFinished":"2025-07-16T16:48:56+0000","dateStarted":"2025-07-16T16:48:54+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752684470388_-1445725734","id":"20250716-164750_104139745","dateCreated":"2025-07-16T16:47:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2817","text":"%sql\r\nWITH user_genre_count AS (\r\n  SELECT r.user_id, mg.genre, COUNT(*) AS genre_count\r\n  FROM ratings r\r\n  JOIN active_users au ON r.user_id = au.user_id\r\n  JOIN movie_genres mg ON r.movie_id = mg.movie_id\r\n  GROUP BY r.user_id, mg.genre\r\n),\r\nranked_genres AS (\r\n  SELECT *,\r\n         ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY genre_count DESC) AS rank\r\n  FROM user_genre_count\r\n)\r\nSELECT g.user_id, au.rating_count, g.genre AS top_genre, g.genre_count AS count\r\nFROM ranked_genres g\r\nJOIN active_users au ON g.user_id = au.user_id\r\nWHERE rank = 1\r\nORDER BY au.rating_count DESC\r\nLIMIT 10\r\n","dateUpdated":"2025-07-16T16:49:04+0000","dateFinished":"2025-07-16T16:51:27+0000","dateStarted":"2025-07-16T16:49:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"user_id\trating_count\ttop_genre\tcount\n405\t737\tDrama\t309\n655\t685\tDrama\t410\n13\t636\tDrama\t218\n450\t540\tDrama\t237\n276\t518\tDrama\t168\n416\t493\tDrama\t212\n537\t490\tDrama\t251\n303\t484\tComedy\t184\n234\t480\tDrama\t213\n393\t448\tComedy\t191\n"}]}},{"text":"%md\nThe output shows the top 10 users who have rated at least 50 movies. The data is expand by the most rated genre by the user and count of the number of rated for the genre. From the results, it shows that user 405 was the most active user with 737 number of rating and 309 of that are rating for Drama genre. User 655 rated about 685 movies which 410 of the 685 movies are from Drama genre followed by user 13 that love to rate movies with Drama genre. The results shows that most of the top users love to rate movies from Drama and comedy genre.","user":"anonymous","dateUpdated":"2025-07-16T16:37:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752665834959_-141504189","id":"20250716-113714_1158576965","dateCreated":"2025-07-16T11:37:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:284","dateFinished":"2025-07-16T16:37:53+0000","dateStarted":"2025-07-16T16:37:52+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The output shows the top 10 users who have rated at least 50 movies. The data is expand by the most rated genre by the user and count of the number of rated for the genre. From the results, it shows that user 405 was the most active user with 737 number of rating and 309 of that are rating for Drama genre. User 655 rated about 685 movies which 410 of the 685 movies are from Drama genre followed by user 13 that love to rate movies with Drama genre. The results shows that most of the top users love to rate movies from Drama and comedy genre.</p>\n"}]}},{"title":"All the users who are less than 20 years old","text":"%spark2.pyspark\nusers = sc.textFile(\"hdfs:///tmp/ml-100k/u.user\") \\\n    .map(lambda line: line.split(\"|\")) \\\n    .map(lambda p: Row(user_id=int(p[0]), age=int(p[1]), gender=p[2], occupation=p[3], zip=p[4]))\n\nuser_df = spark.createDataFrame(users)\nuser_df.createOrReplaceTempView(\"users\")\n","user":"anonymous","dateUpdated":"2025-07-16T16:38:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1752601362426_-1691308275","id":"20250715-174242_705027304","dateCreated":"2025-07-15T17:42:42+0000","dateStarted":"2025-07-16T16:38:20+0000","dateFinished":"2025-07-16T16:38:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:285"},{"text":"%sql\r\nSELECT * FROM users\r\nWHERE age < 20\r\nLIMIT 10","user":"anonymous","dateUpdated":"2025-07-16T16:38:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752674469860_1892981691","id":"20250716-140109_675063925","dateCreated":"2025-07-16T14:01:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:286","dateFinished":"2025-07-16T16:39:06+0000","dateStarted":"2025-07-16T16:38:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\tgender\toccupation\tuser_id\tzip\n7\tM\tstudent\t30\t55436\n19\tF\tstudent\t36\t93117\n18\tF\tstudent\t52\t55105\n16\tM\tnone\t57\t84010\n17\tM\tstudent\t67\t60402\n19\tM\tstudent\t68\t22904\n15\tM\tstudent\t101\t05146\n19\tM\tstudent\t110\t77840\n13\tM\tother\t142\t48118\n15\tM\tentertainment\t179\t20755\n"}]}},{"text":"%md\nThe results shows the first 10 user whose age is less than 20. Most of the user are male and students. ","user":"anonymous","dateUpdated":"2025-07-16T17:17:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752674153946_-1385739522","id":"20250716-135555_1481459005","dateCreated":"2025-07-16T13:55:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:287","dateFinished":"2025-07-16T17:17:04+0000","dateStarted":"2025-07-16T17:17:03+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The results shows the first 10 user whose age is less than 20. Most of the user are male and students.</p>\n"}]}},{"text":"%sql\r\nSELECT *\r\nFROM users\r\nWHERE occupation = 'scientist'\r\n  AND age BETWEEN 30 AND 40\r\n","user":"anonymous","dateUpdated":"2025-07-16T17:18:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752686268142_-553137290","id":"20250716-171748_186037496","dateCreated":"2025-07-16T17:17:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3105","dateFinished":"2025-07-16T17:18:06+0000","dateStarted":"2025-07-16T17:18:04+0000","title":"All the users whose occupation is \"scientist\" and whose age is between 30 and 40 years old","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\tgender\toccupation\tuser_id\tzip\n38\tM\tscientist\t40\t27514\n39\tM\tscientist\t71\t98034\n39\tM\tscientist\t74\tT8H1N\n39\tM\tscientist\t107\t60466\n33\tM\tscientist\t183\t27708\n33\tM\tscientist\t272\t53706\n40\tM\tscientist\t309\t70802\n37\tM\tscientist\t337\t10522\n38\tM\tscientist\t430\t98199\n31\tM\tscientist\t538\t21010\n33\tM\tscientist\t543\t95123\n32\tM\tscientist\t554\t62901\n39\tM\tscientist\t643\t55122\n31\tF\tscientist\t730\t32114\n36\tM\tscientist\t874\t37076\n40\tM\tscientist\t918\t70116\n"}]}},{"text":"%md\nThe results shows the user whose occupation is \"scientist\" and the age is between 30 and 40.\n","user":"anonymous","dateUpdated":"2025-07-16T17:20:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752686332932_-921049183","id":"20250716-171852_1742048860","dateCreated":"2025-07-16T17:18:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3269","dateFinished":"2025-07-16T17:20:26+0000","dateStarted":"2025-07-16T17:20:26+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The results shows the user whose occupation is &ldquo;scientist&rdquo; and the age is between 30 and 40.</p>\n"}]}},{"title":"write the DataFrame into the Keyspace database created in Cassandra","text":"%spark2.pyspark\r\ndef write_to_cassandra(df, keyspace, table, host=\"127.0.0.1\"):\r\n    spark.conf.set(\"spark.cassandra.connection.host\", host)\r\n    \r\n    df.write \\\r\n      .format(\"org.apache.spark.sql.cassandra\") \\\r\n      .options(table=table, keyspace=keyspace) \\\r\n      .mode(\"append\") \\\r\n      .save()\r\n","user":"anonymous","dateUpdated":"2025-07-15T17:53:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752601415630_-665659653","id":"20250715-174335_29818809","dateCreated":"2025-07-15T17:43:35+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:289"},{"text":"write_to_cassandra(user_df, \"movielens\", \"users\", \"192.168.56.1\")","user":"anonymous","dateUpdated":"2025-07-15T17:52:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752601932650_-1119530895","id":"20250715-175212_1846337019","dateCreated":"2025-07-15T17:52:12+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:290"},{"title":"read the table back from Cassandra into a new DataFrame","text":"%spark2.pyspark\r\ndef read_from_cassandra(keyspace, table, host=\"127.0.0.1\"):\r\n    spark.conf.set(\"spark.cassandra.connection.host\", host)\r\n    \r\n    return spark.read \\\r\n        .format(\"org.apache.spark.sql.cassandra\") \\\r\n        .options(table=table, keyspace=keyspace) \\\r\n        .load()\r\n","user":"anonymous","dateUpdated":"2025-07-15T17:54:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752601928067_1885373339","id":"20250715-175208_1056232050","dateCreated":"2025-07-15T17:52:08+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:291"},{"text":"df_from_cassandra = read_from_cassandra(\"movielens\", \"users\", \"192.168.56.1\")\r\ndf_from_cassandra.show(10)\r\n","user":"anonymous","dateUpdated":"2025-07-15T17:52:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1752601954438_1708034745","id":"20250715-175234_257792609","dateCreated":"2025-07-15T17:52:34+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:292"}],"name":"P146224_STQD6324_ASSIGNMENT 3","id":"2M1Q9C3T5","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}